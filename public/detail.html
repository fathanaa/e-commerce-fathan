<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Product Detail - GoldenCart</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <!-- Navbar -->
    <nav class="bg-white shadow-md p-4 flex items-center justify-between">
        <div>
            <span class="text-yellow-600 text-2xl font-bold italic">GoldenCart</span>
        </div>
        <div class="flex items-center space-x-2">
            <input
                type="text"
                id="search-bar"
                placeholder="search your stuff"
                class="border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                onkeyup="searchProducts()"
            />
            <button
                id="search-button"
                class="bg-gray-200 hover:bg-gray-300 rounded-lg p-2"
                onclick="searchProducts()"
            >
                <svg
                    class="w-5 h-5 text-gray-600"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1116.65 16.65z"
                    ></path>
                </svg>
            </button>
        </div>
        <div class="flex items-center space-x-4">
            <a href="cart.html" class="relative text-gray-700 hover:text-orange-500">
                <svg
                    class="w-6 h-6"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M3 3h18l-2 12H5L3 3zm4 16a2 2 0 100-4 2 2 0 000 4zm10 0a2 2 0 100-4 2 2 0 000 4z"
                    ></path>
                </svg>
                <span
                    id="cart-count"
                    class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"
                >0</span>
            </a>
            <a href="profil.html" class="text-gray-700 hover:text-orange-500">
                <svg
                    class="w-6 h-6"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                    ></path>
                </svg>
            </a>
            <span id="username-display" class="text-gray-700"></span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto p-4 flex-grow flex items-start">
        <img
            id="product-image"
            src=""
            alt="Product Image"
            class="w-1/2 max-w-md object-contain mr-6"
        />
        <div class="w-1/2">
            <h1 id="product-title" class="text-2xl font-bold mb-2"></h1>
            <p id="product-price" class="text-xl text-gray-600 mb-4"></p>
            <div class="flex items-center space-x-4 mb-4">
                <button
                    id="decrease-quantity"
                    class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-1 rounded"
                    onclick="updateQuantity(-1)"
                >
                    -
                </button>
                <span id="product-quantity">2</span>
                <button
                    id="increase-quantity"
                    class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-2 py-1 rounded"
                    onclick="updateQuantity(1)"
                >
                    +
                </button>
            </div>
            <div class="flex space-x-4 mb-4">
                <button
                    id="add-to-cart"
                    class="bg-black hover:bg-blue-700 text-white px-4 py-2 rounded-lg"
                    onclick="addToCart()"
                >
                    TAMBAH KERANJANG
                </button>
                <button
                    id="buy-now"
                    class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-lg"
                    onclick="showPurchaseModal()"
                >
                    BELI SEKARANG
                </button>
            </div>
            <div>
                <h3 class="text-lg font-semibold">Deskripsi</h3>
                <p id="product-description" class="text-gray-600 mt-2"></p>
            </div>
        </div>
    </main>

    <!-- Purchase Modal -->
    <div id="purchase-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg max-w-md w-full">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Purchase Details</h2>
                <button onclick="closePurchaseModal()" class="text-gray-600 hover:text-gray-800">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="flex items-start space-x-4">
                <img id="modal-product-image" src="" alt="Product Image" class="w-24 h-24 object-contain">
                <div>
                    <h3 id="modal-product-title" class="text-lg font-semibold"></h3>
                    <p id="modal-product-price" class="text-gray-600"></p>
                    <p id="modal-product-quantity" class="text-gray-600"></p>
                    <p id="modal-total-price" class="text-gray-800 font-bold"></p>
                </div>
            </div>
            <div class="flex justify-end space-x-4 mt-6">
                <button onclick="closePurchaseModal()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-lg">
                    Cancel
                </button>
                <button onclick="confirmPurchase()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                    Confirm Purchase
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-4">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <div class="mb-4 md:mb-0">
                <h2 class="text-3xl font-bold text-yellow-400">GoldenTime</h2>
                <p class="text-sm mt-2">
                    GoldenTime adalah platform digital yang dirancang untuk mempromosikan dan menjual berbagai jenis jam tangan, baik untuk pria maupun wanita. Website ini bertujuan memberikan pengalaman belanja online yang informatif, elegan, dan modern, serta merepresentasikan citra brand yang premium.
                </p>
                <p class="text-xs mt-2">Â© 2025 GoldenTime. Semua Hak Cipta</p>
            </div>
            <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-8 text-sm">
                <div>
                    <h3 class="font-semibold mb-2">Information</h3>
                    <ul class="space-y-1">
                        <li><a href="#" class="hover:text-yellow-400">Contact Us</a></li>
                        <li><a href="#" class="hover:text-yellow-400">Terms & Condition</a></li>
                        <li><a href="#" class="hover:text-yellow-400">Join The Crew</a></li>
                        <li><a href="#" class="hover:text-yellow-400">Community</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold mb-2">Ikuti Kami</h3>
                    <div class="flex space-x-2">
                        <a href="#" class="text-white hover:text-yellow-400">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0 6c-2.757 0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5zm0 2c1.656 0 3 1.344 3 3s-1.344 3-3 3-3-1.344-3-3 1.344-3 3-3z"/>
                            </svg>
                        </a>
                        <a href="#" class="text-white hover:text-yellow-400">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-2.717 0-4.92 2.203-4.92 4.917 0 .386.045.762.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.732-.666 1.585-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.396 0-.788-.023-1.175-.068 2.187 1.405 4.787 2.224 7.574 2.224 9.055 0 14.008-7.496 14.008-13.985 0-.21 0-.42-.015-.63.962-.695 1.8-1.562 2.457-2.549z"/>
                            </svg>
                        </a>
                        <a href="#" class="text-white hover:text-yellow-400">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM10 15.5v-7l6 3.5-6 3.5z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            <div class="mt-4 md:mt-0">
                <a href="#" class="hover:text-yellow-400">Tentang Kami</a> | <a href="#" class="hover:text-yellow-400">Syarat & Ketentuan Pengguna</a>
            </div>
        </div>
    </footer>

    <script>
        let allProducts = [];
        let cart = JSON.parse(localStorage.getItem("cart")) || [];

        // Load username from localStorage
        function loadUsername() {
            const savedData = localStorage.getItem("userData");
            const usernameDisplay = document.getElementById("username-display");
            if (savedData) {
                const userData = JSON.parse(savedData);
                usernameDisplay.textContent = userData.username || "Guest";
            } else {
                usernameDisplay.textContent = "Guest";
            }
        }

        async function fetchProducts() {
            try {
                const response = await fetch("https://fakestoreapi.com/products");
                allProducts = await response.json();
                displayProductDetails();
            } catch (error) {
                console.error("Error fetching products:", error);
                document.getElementById("product-title").textContent = "Error loading product";
            }
        }

        function displayProductDetails() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get("id"));
            const product = allProducts.find((p) => p.id === productId);

            if (product) {
                document.getElementById("product-image").src = product.image;
                document.getElementById("product-title").textContent = product.title;
                document.getElementById("product-price").textContent = `Rp ${(product.price * 34000).toLocaleString("id-ID")}.00`; // Convert USD to IDR
                document.getElementById("product-description").textContent = product.description || "Deskripsi produk tidak tersedia.";
                updateCartCount();
            } else {
                document.getElementById("product-title").textContent = "Product not found";
            }
        }

        let quantity = 1; // Initial quantity set to 2 as per image
        function updateQuantity(change) {
            quantity = Math.max(1, quantity + change);
            document.getElementById("product-quantity").textContent = quantity;
        }

        function addToCart() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get("id"));
            const product = allProducts.find((p) => p.id === productId);

            if (product && !cart.some((item) => item.id === product.id)) {
                cart.push({
                    id: product.id,
                    title: product.title,
                    price: product.price,
                    image: product.image,
                    quantity: quantity,
                });
                localStorage.setItem("cart", JSON.stringify(cart));
                updateCartCount();
                alert("Product added to cart!");
            } else if (cart.some((item) => item.id === product.id)) {
                alert("This product is already in your cart!");
            }
        }

        function showPurchaseModal() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get("id"));
            const product = allProducts.find((p) => p.id === productId);

            if (product) {
                document.getElementById("modal-product-image").src = product.image;
                document.getElementById("modal-product-title").textContent = product.title;
                document.getElementById("modal-product-price").textContent = `Price: Rp ${(product.price * 34000).toLocaleString("id-ID")}.00`;
                document.getElementById("modal-product-quantity").textContent = `Quantity: ${quantity}`;
                document.getElementById("modal-total-price").textContent = `Total: Rp ${(product.price * 34000 * quantity).toLocaleString("id-ID")}.00`;
                document.getElementById("purchase-modal").classList.remove("hidden");
            }
        }

        function closePurchaseModal() {
            document.getElementById("purchase-modal").classList.add("hidden");
        }

        function confirmPurchase() {
            alert(`Purchase confirmed for ${quantity} unit(s) of ${document.getElementById("modal-product-title").textContent}! (Simulated action)`);
            closePurchaseModal();
            // Add actual purchase logic here, e.g., redirect to payment gateway
        }

        function updateCartCount() {
            const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById("cart-count").textContent = cartCount;
        }

        function searchProducts() {
            const searchTerm = document
                .getElementById("search-bar")
                .value.toLowerCase();
            const filteredProducts = allProducts.filter((product) =>
                product.title.toLowerCase().includes(searchTerm)
            );
            // Note: Search on detail page doesn't apply; this is for consistency with navbar
        }

        document.addEventListener("DOMContentLoaded", () => {
            loadUsername();
            fetchProducts();
        });
    </script>
</body>
</html>